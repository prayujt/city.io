FROM node:19.5.0 as frontend

WORKDIR /app/src

ENV MYSQL_USER $MYSQL_USER_ARG
ENV MYSQL_PASSWORD $MYSQL_PASSWORD_ARG
ENV MYSQL_DB_NAME $MYSQL_DB_NAME_ARG
ENV MYSQL_TEST_DB_NAME $MYSQL_TEST_DB_NAME_ARG
ENV MYSQL_HOST $MYSQL_HOST_ARG
ENV API_PORT $API_PORT_ARG
ENV API_HOST $API_HOST_ARG

COPY package*.json ./
RUN npm install

COPY ./ ./
RUN npm run build

FROM nginx:1.18.0
COPY --from=frontend /app/src/dist/client/ /usr/share/nginx/html
